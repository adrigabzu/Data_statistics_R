---
title: "Untitled"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
```

## GitHub Documents

This is an R Markdown format used for publishing markdown documents to GitHub. When you click the **Knit** button all R code chunks are run and a markdown file (.md) suitable for publishing to GitHub is generated.

## Including Code

You can include R code in the document as follows:

```{r}
data = read_excel("../datasets/Data_Cortex_Nuclear.xls")
data
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```


```{r}
# Store operations in a variable with <- or =
ubiquitin_subset <-
  # Select the columns to keep, to select everything but a column use -
  data %>% select(MouseID,
                  Ubiquitin_N,
                  Genotype,
                  ends_with("vior"),
                  contains("Treat") ,
                  class) %>%
  # Keep rows of class c-CS-m and c-SC-m
  filter(class %in% c("c-CS-m", "t-CS-m", "c-SC-m", "t-SC-m")) %>%
  # Sort increasing values by default, use desc(column_name) for descending
  arrange(Ubiquitin_N)

# Show the results
ubiquitin_subset

```


```{r}
ggplot(data = ubiquitin_subset) +
  # Select your x, y values by column name and which categories for the colors
  geom_boxplot(mapping = aes(y = Ubiquitin_N, x = Genotype, fill = Genotype)) +
  # split the different paired plots and remove the color legends
  facet_grid( ~ Behavior) + guides(fill = FALSE) +
  # one of the predefined themes of ggplot2
  theme_bw()
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r}
ggplot(data = ubiquitin_subset) +
  # Boxplots per Behavior grouped by genotype
  geom_boxplot(mapping = aes(y = Ubiquitin_N, x = Behavior, fill = Behavior)) +
  facet_grid( ~ Genotype) + guides(fill = FALSE) +
  theme_bw()
```

