---
title: "Untitled"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
```

## GitHub Documents

This is an R Markdown format used for publishing markdown documents to GitHub. When you click the **Knit** button all R code chunks are run and a markdown file (.md) suitable for publishing to GitHub is generated.

## Including Code

You can include R code in the document as follows:

```{r}
data = read_excel("../datasets/Data_Cortex_Nuclear.xls")
data
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```


```{r}
# Store operations in a variable with <- or =
ubiquitin_subset <-
  # Select the columns to keep, to select everything but a column use -
  data %>% select(MouseID,
                  Ubiquitin_N,
                  Genotype,
                  ends_with("vior"),
                  contains("Treat") ,
                  class) %>%
  # Keep rows of class c-CS-m and c-SC-m
  filter(class %in% c("c-CS-m", "t-CS-m", "c-SC-m", "t-SC-m")) %>%
  # Sort increasing values by default, use desc(column_name) for descending
  arrange(Ubiquitin_N)

# Show the results
ubiquitin_subset

```


```{r}
# Select only the treated samples
treatment_comparison <- ubiquitin_subset %>% filter(Genotype == "Ts65Dn")

# Histograms 
ggplot(data = ubiquitin_subset) +
  geom_histogram(mapping = aes(x = Ubiquitin_N, fill = Behavior)) +
  theme_bw()
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r}
# Qqplot to check normality
ggplot(data = ubiquitin_subset) +
  stat_qq(mapping = aes(sample = Ubiquitin_N, color = Behavior)) +
  facet_grid(~ Behavior) + guides(fill = FALSE) +
  theme_bw()

```

```{r}
# Proceed with a t-test
t.test(Ubiquitin_N ~ Behavior, data = ubiquitin_subset)
```


